{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Session 1 Commandes pour d\u00e9buter Lister toutes les commandes de type \u00ab functions \u00bb Lister toutes les commandes se terminant par \u2018path\u2019. N'afficher que les exemples de l'aide pour la commande Get-Process Afficher de l'aide concernant For Comprendre un script Que fait ce script : Get-Command | Foreach {Get-Help $_ -detailed |Out-File -FilePath C:\\temp\\$_.txt \u2013Encoding ASCII} Syst\u00e8me de fichiers Lister tous les fichiers du r\u00e9pertoire C:\\Windows\\system32 et ses sous-r\u00e9pertoires dont la taille est sup\u00e9rieure ou \u00e9gale \u00e0 10 Mo Copier seulement les sous-r\u00e9pertoires de l\u2019arborescence (r\u00e9cursif) du r\u00e9pertoire 'program files' vers un r\u00e9pertoire de votre choix. Gestion syst\u00e8me R\u00e9cup\u00e9rer tous les services arr\u00eat\u00e9s et envoyer le r\u00e9sultat dans un fichier. Lister tous les ids des mise \u00e0 jour Microsoft et envoyer le r\u00e9sultat dans un fichier. R\u00e9cup\u00e9rer les processus utilisant au moins 100 Mo. R\u00e9cup\u00e9rer dans le journal d\u2019\u00e9v\u00e9nements 'Application' , toutes les entr\u00e9es en erreur.","title":"Session 1"},{"location":"#session-1","text":"","title":"Session 1"},{"location":"#commandes-pour-debuter","text":"Lister toutes les commandes de type \u00ab functions \u00bb Lister toutes les commandes se terminant par \u2018path\u2019. N'afficher que les exemples de l'aide pour la commande Get-Process Afficher de l'aide concernant For","title":"Commandes pour d\u00e9buter"},{"location":"#comprendre-un-script","text":"Que fait ce script : Get-Command | Foreach {Get-Help $_ -detailed |Out-File -FilePath C:\\temp\\$_.txt \u2013Encoding ASCII}","title":"Comprendre un script"},{"location":"#systeme-de-fichiers","text":"Lister tous les fichiers du r\u00e9pertoire C:\\Windows\\system32 et ses sous-r\u00e9pertoires dont la taille est sup\u00e9rieure ou \u00e9gale \u00e0 10 Mo Copier seulement les sous-r\u00e9pertoires de l\u2019arborescence (r\u00e9cursif) du r\u00e9pertoire 'program files' vers un r\u00e9pertoire de votre choix.","title":"Syst\u00e8me de fichiers"},{"location":"#gestion-systeme","text":"R\u00e9cup\u00e9rer tous les services arr\u00eat\u00e9s et envoyer le r\u00e9sultat dans un fichier. Lister tous les ids des mise \u00e0 jour Microsoft et envoyer le r\u00e9sultat dans un fichier. R\u00e9cup\u00e9rer les processus utilisant au moins 100 Mo. R\u00e9cup\u00e9rer dans le journal d\u2019\u00e9v\u00e9nements 'Application' , toutes les entr\u00e9es en erreur.","title":"Gestion syst\u00e8me"},{"location":"Session2/","text":"Session 2 Les fournisseurs Variables d'environnement R\u00e9cup\u00e9rer dans une variable le contenu de la variable d'environnement computername Cr\u00e9er une variable d'environnement nomm\u00e9e login et affecter lui la valeur paul.atreides Registre Retrouver le chemin complet de la cl\u00e9 Winlogon dans le registre (HKEY Current User) \u00c0 l\u2019aide du chemin de registre suivant, extraire les versions et les services pack des Framework .net install\u00e9s : HKLM\\software\\microsoft\\Net Framework setup\\ndp \u00c0 l\u2019aide du chemin de registre suivant, activer le bureau \u00e0 distance de votre machine : HKLM\\SYSTEM\\currentcontrolset\\control\\terminal server\\fdenytsconnections \u00c0 l\u2019aide du chemin de registre suivant, lister toutes les cl\u00e9s usb connect\u00e9s \u00e0 votre machine h\u00f4te : HKLM\\SYSTEM\\CurrentControlSet\\Enum\\USBSTOR Formatage de l'affichage Afficher toutes les propri\u00e9t\u00e9s de la commande Get-Process Puis choisir de n'afficher que les propri\u00e9t\u00e9s ID, Name et WorkingSet Syst\u00e8me de fichiers Afficher les extensions de fichiers pr\u00e9sentes dans le r\u00e9pertoire c:\\Windows de mani\u00e8re unique et dans l'ordre alphab\u00e9tique (exclure les extensions \u2018vides\u2019) Cr\u00e9er un fichier nomm\u00e9e date.log et reculer sa date de cr\u00e9ation d'un mois. Gestion syst\u00e8me Afficher le nombre de services arr\u00eat\u00e9s et d\u00e9marr\u00e9s en seule ligne de commande Afficher tous les processus fabricant (Microsoft, AMD, Intel, etc..) et trier en ordre d\u00e9croissant leurs nombres. V\u00e9rifier la pr\u00e9sence d\u2019une erreur disque dans les journaux d\u2019\u00e9v\u00e8nements (id event 7) Statistiques, manipulation de texte, conversion en objet Mesurer le nombre de lignes, de mots et caract\u00e8res d'un fichier texte Cr\u00e9er une variable nomm\u00e9e chaine avec la valeur Paul Atreides et effectuer les op\u00e9rations suivantes : Convertir les majuscules en minuscule Remplacer l'espace par un point Ajouter le suffixe @cesi.fr Extraire le pr\u00e9nom et le nom de la chaine Transformer le retour de la commande netstat.exe en objet Conditions Proposer \u00e0 l\u2019utilisateur de choisir un chiffre en 1 et 5 et afficher lui le chiffre choisi en toutes lettres Cr\u00e9er une boucle Cr\u00e9er une boucle visuelle avec la commande Write-Progress (Barre de progression) Services WEB \u00c0 l'aide de l'URL suivante, r\u00e9cup\u00e9rer l'ip publique de votre connexion Internet et stocker le r\u00e9sultat dans une variable : https://api.ipify.org?format=json \u00c0 l'aide de l'URL suivante, r\u00e9cup\u00e9rer la liste des communes correspondant au code postal de votre choix : https://geo.api.gouv.fr/communes?codePostal=<code postal>","title":"Session 2"},{"location":"Session2/#session-2","text":"","title":"Session 2"},{"location":"Session2/#les-fournisseurs","text":"","title":"Les fournisseurs"},{"location":"Session2/#variables-denvironnement","text":"R\u00e9cup\u00e9rer dans une variable le contenu de la variable d'environnement computername Cr\u00e9er une variable d'environnement nomm\u00e9e login et affecter lui la valeur paul.atreides","title":"Variables d'environnement"},{"location":"Session2/#registre","text":"Retrouver le chemin complet de la cl\u00e9 Winlogon dans le registre (HKEY Current User) \u00c0 l\u2019aide du chemin de registre suivant, extraire les versions et les services pack des Framework .net install\u00e9s : HKLM\\software\\microsoft\\Net Framework setup\\ndp \u00c0 l\u2019aide du chemin de registre suivant, activer le bureau \u00e0 distance de votre machine : HKLM\\SYSTEM\\currentcontrolset\\control\\terminal server\\fdenytsconnections \u00c0 l\u2019aide du chemin de registre suivant, lister toutes les cl\u00e9s usb connect\u00e9s \u00e0 votre machine h\u00f4te : HKLM\\SYSTEM\\CurrentControlSet\\Enum\\USBSTOR","title":"Registre"},{"location":"Session2/#formatage-de-laffichage","text":"Afficher toutes les propri\u00e9t\u00e9s de la commande Get-Process Puis choisir de n'afficher que les propri\u00e9t\u00e9s ID, Name et WorkingSet","title":"Formatage de l'affichage"},{"location":"Session2/#systeme-de-fichiers","text":"Afficher les extensions de fichiers pr\u00e9sentes dans le r\u00e9pertoire c:\\Windows de mani\u00e8re unique et dans l'ordre alphab\u00e9tique (exclure les extensions \u2018vides\u2019) Cr\u00e9er un fichier nomm\u00e9e date.log et reculer sa date de cr\u00e9ation d'un mois.","title":"Syst\u00e8me de fichiers"},{"location":"Session2/#gestion-systeme","text":"Afficher le nombre de services arr\u00eat\u00e9s et d\u00e9marr\u00e9s en seule ligne de commande Afficher tous les processus fabricant (Microsoft, AMD, Intel, etc..) et trier en ordre d\u00e9croissant leurs nombres. V\u00e9rifier la pr\u00e9sence d\u2019une erreur disque dans les journaux d\u2019\u00e9v\u00e8nements (id event 7)","title":"Gestion syst\u00e8me"},{"location":"Session2/#statistiques-manipulation-de-texte-conversion-en-objet","text":"Mesurer le nombre de lignes, de mots et caract\u00e8res d'un fichier texte Cr\u00e9er une variable nomm\u00e9e chaine avec la valeur Paul Atreides et effectuer les op\u00e9rations suivantes : Convertir les majuscules en minuscule Remplacer l'espace par un point Ajouter le suffixe @cesi.fr Extraire le pr\u00e9nom et le nom de la chaine Transformer le retour de la commande netstat.exe en objet","title":"Statistiques, manipulation de texte, conversion en objet"},{"location":"Session2/#conditions","text":"Proposer \u00e0 l\u2019utilisateur de choisir un chiffre en 1 et 5 et afficher lui le chiffre choisi en toutes lettres","title":"Conditions"},{"location":"Session2/#creer-une-boucle","text":"Cr\u00e9er une boucle visuelle avec la commande Write-Progress (Barre de progression)","title":"Cr\u00e9er une boucle"},{"location":"Session2/#services-web","text":"\u00c0 l'aide de l'URL suivante, r\u00e9cup\u00e9rer l'ip publique de votre connexion Internet et stocker le r\u00e9sultat dans une variable : https://api.ipify.org?format=json \u00c0 l'aide de l'URL suivante, r\u00e9cup\u00e9rer la liste des communes correspondant au code postal de votre choix : https://geo.api.gouv.fr/communes?codePostal=<code postal>","title":"Services WEB"},{"location":"Session3/","text":"Session 3 Gestion Active Directory avec Powershell Param\u00e9trage du serveur Nommer la machine virtuelle \u00e0 l\u2019aide de la commande Powershell suivante : Rename-Computer -NewName DC1 -force Configurer la carte r\u00e9seau comme indiqu\u00e9 ci-dessous avec Powershell : Trouver l\u2019id de la carte r\u00e9seau local \u00e0 l\u2019aide de Powershell : R\u00e9ponse (commande utilis\u00e9e et id de la carte) : Pour configurer l\u2019adresse IPv4, la passerelle et le masque de sous r\u00e9seau : Get-NetAdapter -InterfaceIndex < id_carte_r\u00e9seau > | New-NetIPAddress -IPAddress 192 . 168 . 10 . 12 -DefaultGateway 192 . 168 . 10 . 1 -PrefixLength 24 Que signifie le param\u00e8tre PrefixLength dans la commande pr\u00e9c\u00e9dente ? R\u00e9ponse : V\u00e9rifier la prise en compte de la configuration : Get-NetAdapter -InterfaceIndex < id_carte_r\u00e9seau > | Get-NetIPConfiguration Tester la connexion avec le routeur : Test-Connection 192 . 168 . 10 . 12 -count 1 \u00c0 quelle commande historique correspond la commande ci-dessous ? R\u00e9ponse : Configurer le client DNS Get-NetAdapter -InterfaceIndex < id_carte_r\u00e9seau > | Set-DnsClientServerAddress -ServerAddresses 192 . 168 . 10 . 12 Installation du service d\u2019annuaire Active Directory Cr\u00e9er le domaine cesi<id>.lan \u00e0 l\u2019aide de Powershell : Installation des outils de management et d\u00e9ploiement Active Directory : Install-WindowsFeature AD-Domain-Services , RSAT-ADDS-Tools Comment v\u00e9rifier les r\u00f4les et fonctionnalit\u00e9s install\u00e9s \u00e0 l\u2019aide de la console Powershell : R\u00e9ponse : Red\u00e9marrer le serveur : Restart-Computer Pour installer Active Directory, lancer la commande Powershell suivante : Import-Module ADDSDeployment Install-ADDSForest -CreateDnsDelegation : $false -DatabasePath \"C:\\Windows\\NTDS\" -DomainMode \"Win2012\" ` -DomainName \"cesi.lan\" -DomainNetbiosName \"CESI\" -ForestMode \"Win2012\" -InstallDns : $true ` -LogPath \"C:\\Windows\\NTDS\" -NoRebootOnCompletion : $false -SysvolPath \"C:\\Windows\\SYSVOL\" -Force : $true ` -SafeModeAdministratorPassword ( ConvertTo-SecureString \"P@ssword\" -AsPlainText -Force ) Red\u00e9marrer le serveur : Restart-Computer V\u00e9rification de l\u2019installation d\u2019Active Directory Rester la configuration d\u2019Active Directory avec la commande DCDIAG.exe Tester la r\u00e9solution de nom directe et inverse du nom FQDN de votre DC : R\u00e9ponse : En principe, il est conseill\u00e9 de g\u00e9rer son domaine AD depuis une console de type client. Dans cas les outils de gestion RSAT doivent \u00eatre install\u00e9s, dans le cas d\u2019un DC, ils sont install\u00e9s automatiquement. En dehors de cet exercice, il est vivement conseill\u00e9 d\u2019utiliser un poste de travail qui n'est pas un contr\u00f4leur de domaine pour administrer ActiveDirectory. Depuis Powershell v3, l\u2019import d\u2019un module dans la session courante est automatique : Dans ce cas la commande implicite ex\u00e9cut\u00e9e est Import-module ActiveDirectory lors du premier lancement de la commande ActiveDirectory. Cr\u00e9er une unit\u00e9 d'organistation (OU) nomm\u00e9e Annuaire (avec Powershell) Cr\u00e9er un utilisateur lambda avec une adresse mail et une ville \u00e0 l\u2019aide de la commande New-Aduser , puis lui ajouter un mot de passe. (dans l\u2019OU Annuaire cr\u00e9e pr\u00e9c\u00e9demment) Cr\u00e9er un deuxi\u00e8me utilisateur avec mot de passe \u00e0 l\u2019aide d\u2019une seule ligne de commande Lister tous les comptes dont le mot de passe n\u2019a pas \u00e9t\u00e9 chang\u00e9 depuis un mois. (dans le cadre de ce TP, une heure suffira \u00e9tant donn\u00e9 la date de cr\u00e9ation des comptes) \u00c0 l\u2019aide la commande pr\u00e9c\u00e9dente, forcer le changement de passe des comptes concern\u00e9s Cr\u00e9ation d'utilisateurs depuis un fichier de type CSV \u00c0 l\u2019aide du fichier CSV fourni par le formateur, cr\u00e9ez un grand nombre de comptes tel que : Login : prenom.nom (limit\u00e9 \u00e0 20 caract\u00e8res) sans accent Mot de passe : nombre al\u00e9atoire de 8 caract\u00e8res Email : prenom.nom@votredomaine.xxx (sans limitation de caract\u00e8re) Forcer le changement de mot de passe \u00e0 la premi\u00e8re ouverture de session Cr\u00e9er l\u2019utilisateur dans l\u2019OU pr\u00e9c\u00e9demment cr\u00e9e Fichier CSV : Lien Fonction : Remove-Diacritics Cr\u00e9ation d'utilisateurs Active Directory depuis une base de donn\u00e9es MySQL Pr\u00e9requis base de donn\u00e9es MariaDB (Mysql) Installer MariaDB sur votre machine : mariadb-10.3.7-winx64.msi Choisir UTF8 comme jeu de caract\u00e8re Dans une console CMD.exe, se connecter au serveur MariaDB : mysql -u root -p Cr\u00e9er la base de donn\u00e9es \u00e0 l'aide de la commande suivante : CREATE DATABASE RH ; Cr\u00e9er la table rh_users : USE RH ; CREATE TABLE rh_users ( surname VARCHAR ( 100 ), givenname VARCHAR ( 100 ), city VARCHAR ( 100 )); Charger le fichier CSV dans la table rh_users; LOAD DATA LOCAL INFILE 'C:/TP/CSV/BaseDonneesExempleCsv.csv' INTO TABLE rh_users FIELDS TERMINATED BY ';' LINES TERMINATED BY '\\n' IGNORE 1 LINES ( surname , givenname , city ); Cr\u00e9ation des utilisateurs depuis Mysql Supprimer tous les comptes Active Directory que vous avez cr\u00e9\u00e9s pr\u00e9c\u00e9demment. A l'aide des scripts fournis, cr\u00e9er tous les comptes pr\u00e9sents dans la BDD MySQL dans l\u2019AD tel que : Login (samaccountname) : prenom.nom (limit\u00e9 \u00e0 20 caract\u00e8res) sans accent (fonction Remove-Diacritics fournie) Login (UPN) : prenom.nom@votredomaine.xxx (sans limitation de caract\u00e8re) Mot de passe : nombre al\u00e9atoire de 8 caract\u00e8res Email : prenom.nom@votredomaine.xxx (sans limitation de caract\u00e8re) Forcer le changement de mot de passe \u00e0 la premi\u00e8re ouverture de session Cr\u00e9er l\u2019utilisateur dans l\u2019OU pr\u00e9c\u00e9demment cr\u00e9e Cr\u00e9er les dossiers personnels des utilisateurs avec attribution des droits NTFS inh\u00e9rents dans le dossier partag\u00e9 : \\\\srv-data\\home\\<username> , voir script SetFolderPermission.ps1 pour les droits NTFS Connecteur : .Net Mysl Fonction : Get-Mysql Script : SetFolderPermission Remplacer le serveur de fichier h\u00e9bergeant les r\u00e9pertoires personnels par \\\\srv-data2 pour tous les utilisateurs cr\u00e9\u00e9s pr\u00e9alablement. \u00c0 l'aide de la fonction Fill-PDF , du fichier Formulaire.pdf et de la DLL itextsharp.dll g\u00e9n\u00e9rer un export pour chaque utilisateur de l'OU Annuaire . Simuler la transmission par mail de chaque export PDF vers l'utilisateur concern\u00e9. (G\u00e9n\u00e9rer la commande \"send-mailmessage\" sous forme d'une chaine de caract\u00e8re)","title":"Session 3"},{"location":"Session3/#session-3","text":"","title":"Session 3"},{"location":"Session3/#gestion-active-directory-avec-powershell","text":"","title":"Gestion Active Directory avec Powershell"},{"location":"Session3/#parametrage-du-serveur","text":"Nommer la machine virtuelle \u00e0 l\u2019aide de la commande Powershell suivante : Rename-Computer -NewName DC1 -force Configurer la carte r\u00e9seau comme indiqu\u00e9 ci-dessous avec Powershell : Trouver l\u2019id de la carte r\u00e9seau local \u00e0 l\u2019aide de Powershell : R\u00e9ponse (commande utilis\u00e9e et id de la carte) : Pour configurer l\u2019adresse IPv4, la passerelle et le masque de sous r\u00e9seau : Get-NetAdapter -InterfaceIndex < id_carte_r\u00e9seau > | New-NetIPAddress -IPAddress 192 . 168 . 10 . 12 -DefaultGateway 192 . 168 . 10 . 1 -PrefixLength 24 Que signifie le param\u00e8tre PrefixLength dans la commande pr\u00e9c\u00e9dente ? R\u00e9ponse : V\u00e9rifier la prise en compte de la configuration : Get-NetAdapter -InterfaceIndex < id_carte_r\u00e9seau > | Get-NetIPConfiguration Tester la connexion avec le routeur : Test-Connection 192 . 168 . 10 . 12 -count 1 \u00c0 quelle commande historique correspond la commande ci-dessous ? R\u00e9ponse : Configurer le client DNS Get-NetAdapter -InterfaceIndex < id_carte_r\u00e9seau > | Set-DnsClientServerAddress -ServerAddresses 192 . 168 . 10 . 12","title":"Param\u00e9trage du serveur"},{"location":"Session3/#installation-du-service-dannuaire-active-directory","text":"Cr\u00e9er le domaine cesi<id>.lan \u00e0 l\u2019aide de Powershell : Installation des outils de management et d\u00e9ploiement Active Directory : Install-WindowsFeature AD-Domain-Services , RSAT-ADDS-Tools Comment v\u00e9rifier les r\u00f4les et fonctionnalit\u00e9s install\u00e9s \u00e0 l\u2019aide de la console Powershell : R\u00e9ponse : Red\u00e9marrer le serveur : Restart-Computer Pour installer Active Directory, lancer la commande Powershell suivante : Import-Module ADDSDeployment Install-ADDSForest -CreateDnsDelegation : $false -DatabasePath \"C:\\Windows\\NTDS\" -DomainMode \"Win2012\" ` -DomainName \"cesi.lan\" -DomainNetbiosName \"CESI\" -ForestMode \"Win2012\" -InstallDns : $true ` -LogPath \"C:\\Windows\\NTDS\" -NoRebootOnCompletion : $false -SysvolPath \"C:\\Windows\\SYSVOL\" -Force : $true ` -SafeModeAdministratorPassword ( ConvertTo-SecureString \"P@ssword\" -AsPlainText -Force ) Red\u00e9marrer le serveur : Restart-Computer","title":"Installation du service d\u2019annuaire Active Directory"},{"location":"Session3/#verification-de-linstallation-dactive-directory","text":"Rester la configuration d\u2019Active Directory avec la commande DCDIAG.exe Tester la r\u00e9solution de nom directe et inverse du nom FQDN de votre DC : R\u00e9ponse : En principe, il est conseill\u00e9 de g\u00e9rer son domaine AD depuis une console de type client. Dans cas les outils de gestion RSAT doivent \u00eatre install\u00e9s, dans le cas d\u2019un DC, ils sont install\u00e9s automatiquement. En dehors de cet exercice, il est vivement conseill\u00e9 d\u2019utiliser un poste de travail qui n'est pas un contr\u00f4leur de domaine pour administrer ActiveDirectory. Depuis Powershell v3, l\u2019import d\u2019un module dans la session courante est automatique : Dans ce cas la commande implicite ex\u00e9cut\u00e9e est Import-module ActiveDirectory lors du premier lancement de la commande ActiveDirectory. Cr\u00e9er une unit\u00e9 d'organistation (OU) nomm\u00e9e Annuaire (avec Powershell) Cr\u00e9er un utilisateur lambda avec une adresse mail et une ville \u00e0 l\u2019aide de la commande New-Aduser , puis lui ajouter un mot de passe. (dans l\u2019OU Annuaire cr\u00e9e pr\u00e9c\u00e9demment) Cr\u00e9er un deuxi\u00e8me utilisateur avec mot de passe \u00e0 l\u2019aide d\u2019une seule ligne de commande Lister tous les comptes dont le mot de passe n\u2019a pas \u00e9t\u00e9 chang\u00e9 depuis un mois. (dans le cadre de ce TP, une heure suffira \u00e9tant donn\u00e9 la date de cr\u00e9ation des comptes) \u00c0 l\u2019aide la commande pr\u00e9c\u00e9dente, forcer le changement de passe des comptes concern\u00e9s","title":"V\u00e9rification de l\u2019installation d\u2019Active Directory"},{"location":"Session3/#creation-dutilisateurs-depuis-un-fichier-de-type-csv","text":"\u00c0 l\u2019aide du fichier CSV fourni par le formateur, cr\u00e9ez un grand nombre de comptes tel que : Login : prenom.nom (limit\u00e9 \u00e0 20 caract\u00e8res) sans accent Mot de passe : nombre al\u00e9atoire de 8 caract\u00e8res Email : prenom.nom@votredomaine.xxx (sans limitation de caract\u00e8re) Forcer le changement de mot de passe \u00e0 la premi\u00e8re ouverture de session Cr\u00e9er l\u2019utilisateur dans l\u2019OU pr\u00e9c\u00e9demment cr\u00e9e Fichier CSV : Lien Fonction : Remove-Diacritics","title":"Cr\u00e9ation d'utilisateurs depuis un fichier de type CSV"},{"location":"Session3/#creation-dutilisateurs-active-directory-depuis-une-base-de-donnees-mysql","text":"","title":"Cr\u00e9ation d'utilisateurs Active Directory depuis une base de donn\u00e9es MySQL"},{"location":"Session3/#prerequis-base-de-donnees-mariadb-mysql","text":"Installer MariaDB sur votre machine : mariadb-10.3.7-winx64.msi Choisir UTF8 comme jeu de caract\u00e8re Dans une console CMD.exe, se connecter au serveur MariaDB : mysql -u root -p Cr\u00e9er la base de donn\u00e9es \u00e0 l'aide de la commande suivante : CREATE DATABASE RH ; Cr\u00e9er la table rh_users : USE RH ; CREATE TABLE rh_users ( surname VARCHAR ( 100 ), givenname VARCHAR ( 100 ), city VARCHAR ( 100 )); Charger le fichier CSV dans la table rh_users; LOAD DATA LOCAL INFILE 'C:/TP/CSV/BaseDonneesExempleCsv.csv' INTO TABLE rh_users FIELDS TERMINATED BY ';' LINES TERMINATED BY '\\n' IGNORE 1 LINES ( surname , givenname , city );","title":"Pr\u00e9requis base de donn\u00e9es MariaDB (Mysql)"},{"location":"Session3/#creation-des-utilisateurs-depuis-mysql","text":"Supprimer tous les comptes Active Directory que vous avez cr\u00e9\u00e9s pr\u00e9c\u00e9demment. A l'aide des scripts fournis, cr\u00e9er tous les comptes pr\u00e9sents dans la BDD MySQL dans l\u2019AD tel que : Login (samaccountname) : prenom.nom (limit\u00e9 \u00e0 20 caract\u00e8res) sans accent (fonction Remove-Diacritics fournie) Login (UPN) : prenom.nom@votredomaine.xxx (sans limitation de caract\u00e8re) Mot de passe : nombre al\u00e9atoire de 8 caract\u00e8res Email : prenom.nom@votredomaine.xxx (sans limitation de caract\u00e8re) Forcer le changement de mot de passe \u00e0 la premi\u00e8re ouverture de session Cr\u00e9er l\u2019utilisateur dans l\u2019OU pr\u00e9c\u00e9demment cr\u00e9e Cr\u00e9er les dossiers personnels des utilisateurs avec attribution des droits NTFS inh\u00e9rents dans le dossier partag\u00e9 : \\\\srv-data\\home\\<username> , voir script SetFolderPermission.ps1 pour les droits NTFS Connecteur : .Net Mysl Fonction : Get-Mysql Script : SetFolderPermission Remplacer le serveur de fichier h\u00e9bergeant les r\u00e9pertoires personnels par \\\\srv-data2 pour tous les utilisateurs cr\u00e9\u00e9s pr\u00e9alablement. \u00c0 l'aide de la fonction Fill-PDF , du fichier Formulaire.pdf et de la DLL itextsharp.dll g\u00e9n\u00e9rer un export pour chaque utilisateur de l'OU Annuaire . Simuler la transmission par mail de chaque export PDF vers l'utilisateur concern\u00e9. (G\u00e9n\u00e9rer la commande \"send-mailmessage\" sous forme d'une chaine de caract\u00e8re)","title":"Cr\u00e9ation des utilisateurs depuis Mysql"},{"location":"Session4/","text":"Session 4 Utilisation de WMI Pr\u00e9requis 3 machines Windows virtuelles nomm\u00e9es Client1, Client2, Client3. Les VMs doivent pouvoir communiquer avec la machine h\u00f4te. (NIC Bridged ou host-only) D\u00e9marrer les machines virtuelles cr\u00e9\u00e9es pr\u00e9c\u00e9demment et configurer le mot de passe : P@ssword pour le compte administrateur \u2013 important pour la suite Sur chaque VM, lancer la commande suivante pour autoriser WMI et DCOM distant : netsh advfirewall firewall set rule group=\"Infrastructure de gestion Windows (WMI)\" new enable=yes WMI/CIM (Windows Management Instrumentation) Sur l\u2019h\u00f4te h\u00e9bergeant les VMs, lancer une console powershell, puis la commande suivante : Get-WmiObject win32_bios -ComputerName client1 -Credential administrateur \u00c0 l\u2019aide de la commande pr\u00e9c\u00e9dente, cr\u00e9er un script qui va interroger toutes les VMs \u00e0 l\u2019aide d\u2019une boucle. Adapter votre script pour d\u00e9tecter le syst\u00e8me d\u2019exploitation Adapter le script pour afficher, le nom de la machine, le nom du syst\u00e8me d\u2019exploitation, sa version et son architecture (x64 ou x86). \u00c0 l\u2019aide de la classe WMI win32_LogicalDisk , afficher la taille et l\u2019espace libre des partitions de votre h\u00f4te. Affiner la sortie de la commande pr\u00e9c\u00e9dente pour afficher en tableau les colonnes suivantes : Name, Espace Libre (en GB) et taille (en GB). Garder ce script pour la prochaine partie. Conseil : utiliser la syntaxe : @{label = <string> ; expression = {<script>}} Envoi de message et HTML \u00c0 l\u2019aide de la commande **Send-Mailmessage, envoyez-vous un mail de test (adaptez les param\u00e8tres de la commande en fonction de votre fournisseur de messagerie : SSL ?, Port 25 ou 587\u2026) \u00c0 l\u2019aide du script de la derni\u00e8re partie (concernant Win32_LogicalDisk), envoyer la liste des partitions de vos 3 VMs \u00e0 votre adresse mail. R\u00e9p\u00e9tez l\u2019op\u00e9ration pr\u00e9c\u00e9dente en convertissant le retour du script en HTML.","title":"Session 4"},{"location":"Session4/#session-4","text":"","title":"Session 4"},{"location":"Session4/#utilisation-de-wmi","text":"","title":"Utilisation de WMI"},{"location":"Session4/#prerequis","text":"3 machines Windows virtuelles nomm\u00e9es Client1, Client2, Client3. Les VMs doivent pouvoir communiquer avec la machine h\u00f4te. (NIC Bridged ou host-only) D\u00e9marrer les machines virtuelles cr\u00e9\u00e9es pr\u00e9c\u00e9demment et configurer le mot de passe : P@ssword pour le compte administrateur \u2013 important pour la suite Sur chaque VM, lancer la commande suivante pour autoriser WMI et DCOM distant : netsh advfirewall firewall set rule group=\"Infrastructure de gestion Windows (WMI)\" new enable=yes","title":"Pr\u00e9requis"},{"location":"Session4/#wmicim-windows-management-instrumentation","text":"Sur l\u2019h\u00f4te h\u00e9bergeant les VMs, lancer une console powershell, puis la commande suivante : Get-WmiObject win32_bios -ComputerName client1 -Credential administrateur \u00c0 l\u2019aide de la commande pr\u00e9c\u00e9dente, cr\u00e9er un script qui va interroger toutes les VMs \u00e0 l\u2019aide d\u2019une boucle. Adapter votre script pour d\u00e9tecter le syst\u00e8me d\u2019exploitation Adapter le script pour afficher, le nom de la machine, le nom du syst\u00e8me d\u2019exploitation, sa version et son architecture (x64 ou x86). \u00c0 l\u2019aide de la classe WMI win32_LogicalDisk , afficher la taille et l\u2019espace libre des partitions de votre h\u00f4te. Affiner la sortie de la commande pr\u00e9c\u00e9dente pour afficher en tableau les colonnes suivantes : Name, Espace Libre (en GB) et taille (en GB). Garder ce script pour la prochaine partie. Conseil : utiliser la syntaxe : @{label = <string> ; expression = {<script>}}","title":"WMI/CIM (Windows Management Instrumentation)"},{"location":"Session4/#envoi-de-message-et-html","text":"\u00c0 l\u2019aide de la commande **Send-Mailmessage, envoyez-vous un mail de test (adaptez les param\u00e8tres de la commande en fonction de votre fournisseur de messagerie : SSL ?, Port 25 ou 587\u2026) \u00c0 l\u2019aide du script de la derni\u00e8re partie (concernant Win32_LogicalDisk), envoyer la liste des partitions de vos 3 VMs \u00e0 votre adresse mail. R\u00e9p\u00e9tez l\u2019op\u00e9ration pr\u00e9c\u00e9dente en convertissant le retour du script en HTML.","title":"Envoi de message et HTML"},{"location":"Session5/","text":"Session 5 Utilisation d'un module Sur la machine DC, (n\u00e9cessiste un acc\u00e8s internet, ajouter d'une carte r\u00e9seau virtuelle si n\u00e9cessaire) Installation Framework.NET 4.7 : Lien Installer le module Universal Dashboard via la commande suivante : Install-Module UniversalDashboard -Force Installer le script suivant : Install-Script -Name server-performance-dashboard Pour v\u00e9rifier les scripts install\u00e9s : Get-InstalledScript Lancer le script : server-performance-dashboard . ps1 Dans un navigateur, saisir l'adresse http://localhost:10000 Le script server-performance-dashboard.ps1 est un exemple, le module Universal Dashboard est enti\u00e8rement personnalisable. Plus d'informations sur le site de l'auteur : https://www.poshud.com - Noter que ce module est payant.","title":"Session 5"},{"location":"Session5/#session-5","text":"","title":"Session 5"},{"location":"Session5/#utilisation-dun-module","text":"Sur la machine DC, (n\u00e9cessiste un acc\u00e8s internet, ajouter d'une carte r\u00e9seau virtuelle si n\u00e9cessaire) Installation Framework.NET 4.7 : Lien Installer le module Universal Dashboard via la commande suivante : Install-Module UniversalDashboard -Force Installer le script suivant : Install-Script -Name server-performance-dashboard Pour v\u00e9rifier les scripts install\u00e9s : Get-InstalledScript Lancer le script : server-performance-dashboard . ps1 Dans un navigateur, saisir l'adresse http://localhost:10000 Le script server-performance-dashboard.ps1 est un exemple, le module Universal Dashboard est enti\u00e8rement personnalisable. Plus d'informations sur le site de l'auteur : https://www.poshud.com - Noter que ce module est payant.","title":"Utilisation d'un module"}]}